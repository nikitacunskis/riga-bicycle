import{_ as F}from"./AdminLayout.fa9b63d2.js";import{U as V,r as O,G as U,V as S,k as E,o as k,e as w,b as d,m as q,p as $,F as D,f as R,t as b,u as W,c as P,J as Q,a as X,w as K,d as G,h as Z,i as Y}from"./app.ff9256fe.js";import{_ as J}from"./_plugin-vue_export-helper.cdc0426e.js";import{C as A,r as tt}from"./chart.5edeca99.js";var T={exports:{}};(function(_,f){(function(m,p){p(f)})(V,function(m){var p=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,i=this._zoom;if(t.__parent)for(;e.__parent._zoom>=i;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var i=this._featureGroup,s=this._nonPointGroup,n=this.options.chunkedLoading,l=this.options.chunkInterval,r=this.options.chunkProgress,h=t.length,a=0,u=!0,o;if(this._map){var g=new Date().getTime(),c=L.bind(function(){var C=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();a<h;a++){if(n&&a%200===0){var M=new Date().getTime()-C;if(M>l)break}if(o=t[a],o instanceof L.LayerGroup){u&&(t=t.slice(),u=!1),this._extractNonGroupLayers(o,t),h=t.length;continue}if(!o.getLatLng){s.addLayer(o),e||this.fire("layeradd",{layer:o});continue}if(!this.hasLayer(o)&&(this._addLayer(o,this._maxZoom),e||this.fire("layeradd",{layer:o}),o.__parent&&o.__parent.getChildCount()===2)){var x=o.__parent.getAllChildMarkers(),z=x[0]===o?x[1]:x[0];i.removeLayer(z)}}r&&r(a,h,new Date().getTime()-g),a===h?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(c,this.options.chunkDelay)},this);c()}else for(var v=this._needsClustering;a<h;a++){if(o=t[a],o instanceof L.LayerGroup){u&&(t=t.slice(),u=!1),this._extractNonGroupLayers(o,t),h=t.length;continue}if(!o.getLatLng){s.addLayer(o);continue}this.hasLayer(o)||v.push(o)}return this},removeLayers:function(t){var e,i,s=t.length,n=this._featureGroup,l=this._nonPointGroup,r=!0;if(!this._map){for(e=0;e<s;e++){if(i=t[e],i instanceof L.LayerGroup){r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(i,t),s=t.length;continue}this._arraySplice(this._needsClustering,i),l.removeLayer(i),this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i})}return this}if(this._unspiderfy){this._unspiderfy();var h=t.slice(),a=s;for(e=0;e<a;e++){if(i=h[e],i instanceof L.LayerGroup){this._extractNonGroupLayers(i,h),a=h.length;continue}this._unspiderfyLayer(i)}}for(e=0;e<s;e++){if(i=t[e],i instanceof L.LayerGroup){r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(i,t),s=t.length;continue}if(!i.__parent){l.removeLayer(i),this.fire("layerremove",{layer:i});continue}this._removeLayer(i,!0,!0),this.fire("layerremove",{layer:i}),n.hasLayer(i)&&(n.removeLayer(i),i.clusterShow&&i.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var i=this._needsClustering.slice(),s=this._needsRemoving,n,l,r;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(i),l=i.length-1;l>=0;l--){for(n=!0,r=s.length-1;r>=0;r--)if(s[r].layer===i[l]){n=!1;break}n&&t.call(e,i[l])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer(function(i){L.stamp(i)===t&&(e=i)}),e},hasLayer:function(t){if(!t)return!1;var e,i=this._needsClustering;for(e=i.length-1;e>=0;e--)if(i[e]===t)return!0;for(i=this._needsRemoving,e=i.length-1;e>=0;e--)if(i[e].layer===t)return!1;return!!(t.__parent&&t.__parent._group===this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var i=this._map;typeof e!="function"&&(e=function(){});var s=function(){(i.hasLayer(t)||i.hasLayer(t.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",s,this),this.off("animationend",s,this),i.hasLayer(t)?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",s,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",s,this),this.on("animationend",s,this),t.__parent.zoomToBounds())},onAdd:function(t){this._map=t;var e,i,s;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,i=this._needsRemoving.length;e<i;e++)s=this._needsRemoving[e],s.newlatlng=s.layer._latlng,s.layer._latlng=s.latlng;for(e=0,i=this._needsRemoving.length;e<i;e++)s=this._needsRemoving[e],this._removeLayer(s.layer,!0),s.layer._latlng=s.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var i=t.length-1;i>=0;i--)if(t[i]===e)return t.splice(i,1),!0},_removeFromGridUnclustered:function(t,e){for(var i=this._map,s=this._gridUnclustered,n=Math.floor(this._map.getMinZoom());e>=n&&s[e].removeObject(t,i.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,i){t._latlng=e,this.removeLayer(t),t._latlng=i,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,i){var s=this._gridClusters,n=this._gridUnclustered,l=this._featureGroup,r=this._map,h=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var a=t.__parent,u=a._markers,o;for(this._arraySplice(u,t);a&&(a._childCount--,a._boundsNeedUpdate=!0,!(a._zoom<h));)e&&a._childCount<=1?(o=a._markers[0]===t?a._markers[1]:a._markers[0],s[a._zoom].removeObject(a,r.project(a._cLatLng,a._zoom)),n[a._zoom].addObject(o,r.project(o.getLatLng(),a._zoom)),this._arraySplice(a.__parent._childClusters,a),a.__parent._markers.push(o),o.__parent=a.__parent,a._icon&&(l.removeLayer(a),i||l.addLayer(o))):a._iconNeedsUpdate=!0,a=a.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,i){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,i)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return e<10?i+="small":e<100?i+="medium":i+="large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,s=this.options.zoomToBoundsOnClick,n=this.options.spiderfyOnEveryZoom;(e||s||n)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=t.layer,i=e;if(!(t.type==="clusterkeypress"&&t.originalEvent&&t.originalEvent.keyCode!==13)){for(;i._childClusters.length===1;)i=i._childClusters[0];i._zoom===this._maxZoom&&i._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),this.options.spiderfyOnEveryZoom&&e.spiderfy(),t.originalEvent&&t.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,s=this.options.spiderfyOnEveryZoom,n=this._map;(t||i||s)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){!this._map||(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),i=this.options.maxClusterRadius,s=i;typeof i!="function"&&(s=function(){return i}),this.options.disableClusteringAtZoom!==null&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var n=t;n>=e;n--)this._gridClusters[n]=new L.DistanceGrid(s(n)),this._gridUnclustered[n]=new L.DistanceGrid(s(n));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var i=this._gridClusters,s=this._gridUnclustered,n=Math.floor(this._map.getMinZoom()),l,r;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=n;e--){l=this._map.project(t.getLatLng(),e);var h=i[e].getNearObject(l);if(h){h._addChild(t),t.__parent=h;return}if(h=s[e].getNearObject(l),h){var a=h.__parent;a&&this._removeLayer(h,!1);var u=new this._markerCluster(this,e,h,t);i[e].addObject(u,this._map.project(u._cLatLng,e)),h.__parent=u,t.__parent=u;var o=u;for(r=e-1;r>a._zoom;r--)o=new this._markerCluster(this,r,o),i[r].addObject(o,this._map.project(h.getLatLng(),r));a._addChild(o),this._removeFromGridUnclustered(h,e);return}s[e].addObject(t,l)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()})},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(t){var e=this._maxLat;return e!==void 0&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(e._childCount===2){e._addToMap();var i=e.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var i=t.getLayers(),s=0,n;for(e=e||[];s<i.length;s++){if(n=i[s],n instanceof L.LayerGroup){this._extractNonGroupLayers(n,e);continue}e.push(n)}return e},_overrideMarkerIcon:function(t){var e=t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}});return e}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var i=this._getExpandedVisibleBounds(),s=this._featureGroup,n=Math.floor(this._map.getMinZoom()),l;this._ignoreMove=!0,this._topClusterLevel._recursively(i,t,n,function(r){var h=r._latlng,a=r._markers,u;for(i.contains(h)||(h=null),r._isSingleParent()&&t+1===e?(s.removeLayer(r),r._recursivelyAddChildrenToMap(null,e,i)):(r.clusterHide(),r._recursivelyAddChildrenToMap(h,e,i)),l=a.length-1;l>=0;l--)u=a[l],i.contains(u._latlng)||s.removeLayer(u)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,e),s.eachLayer(function(r){!(r instanceof L.MarkerCluster)&&r._icon&&r.clusterShow()}),this._topClusterLevel._recursively(i,t,e,function(r){r._recursivelyRestoreChildPositions(e)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(i,t,n,function(r){s.removeLayer(r),r.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var i=this,s=this._featureGroup;s.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue(function(){s.removeLayer(t),t.clusterShow(),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,i){var s=this._getExpandedVisibleBounds(),n=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(s,n,e+1,i);var l=this;this._forceLayout(),t._recursivelyBecomeVisible(s,i),this._enqueue(function(){if(t._childCount===1){var r=t._markers[0];this._ignoreMove=!0,r.setLatLng(r.getLatLng()),this._ignoreMove=!1,r.clusterShow&&r.clusterShow()}else t._recursively(s,i,n,function(h){h._recursivelyRemoveChildrenFromMap(s,n,e+1)});l._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var y=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,i,s){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),s&&this._addChild(s)},getAllChildMarkers:function(t,e){t=t||[];for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i].getAllChildMarkers(t,e);for(var s=this._markers.length-1;s>=0;s--)e&&this._markers[s].__dragStart||t.push(this._markers[s]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e=this._childClusters.slice(),i=this._group._map,s=i.getBoundsZoom(this._bounds),n=this._zoom+1,l=i.getZoom(),r;e.length>0&&s>n;){n++;var h=[];for(r=0;r<e.length;r++)h=h.concat(e[r]._childClusters);e=h}s>n?this._group._map.setView(this._latlng,n):s<=l?this._group._map.setView(this._latlng,l+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t=this._markers,e=this._childClusters,i=0,s=0,n=this._childCount,l,r,h,a;if(n!==0){for(this._resetBounds(),l=0;l<t.length;l++)h=t[l]._latlng,this._bounds.extend(h),i+=h.lat,s+=h.lng;for(l=0;l<e.length;l++)r=e[l],r._boundsNeedUpdate&&r._recalculateBounds(),this._bounds.extend(r._bounds),h=r._wLatLng,a=r._childCount,i+=h.lat*a,s+=h.lng*a;this._latlng=this._wLatLng=new L.LatLng(i/n,s/n),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,i){this._recursively(t,this._group._map.getMinZoom(),i-1,function(s){var n=s._markers,l,r;for(l=n.length-1;l>=0;l--)r=n[l],r._icon&&(r._setPos(e),r.clusterHide())},function(s){var n=s._childClusters,l,r;for(l=n.length-1;l>=0;l--)r=n[l],r._icon&&(r._setPos(e),r.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,i,s){this._recursively(t,s,e,function(n){n._recursivelyAnimateChildrenIn(t,n._group._map.latLngToLayerPoint(n.getLatLng()).round(),i),n._isSingleParent()&&i-1===s?(n.clusterShow(),n._recursivelyRemoveChildrenFromMap(t,e,i)):n.clusterHide(),n._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,function(i){i.clusterShow()})},_recursivelyAddChildrenToMap:function(t,e,i){this._recursively(i,this._group._map.getMinZoom()-1,e,function(s){if(e!==s._zoom)for(var n=s._markers.length-1;n>=0;n--){var l=s._markers[n];!i.contains(l._latlng)||(t&&(l._backupLatlng=l.getLatLng(),l.setLatLng(t),l.clusterHide&&l.clusterHide()),s._group._featureGroup.addLayer(l))}},function(s){s._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._restorePosition();else for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i,s){var n,l;this._recursively(t,e-1,i-1,function(r){for(l=r._markers.length-1;l>=0;l--)n=r._markers[l],(!s||!s.contains(n._latlng))&&(r._group._featureGroup.removeLayer(n),n.clusterShow&&n.clusterShow())},function(r){for(l=r._childClusters.length-1;l>=0;l--)n=r._childClusters[l],(!s||!s.contains(n._latlng))&&(r._group._featureGroup.removeLayer(n),n.clusterShow&&n.clusterShow())})},_recursively:function(t,e,i,s,n){var l=this._childClusters,r=this._zoom,h,a;if(e<=r&&(s&&s(this),n&&r===i&&n(this)),r<e||r<i)for(h=l.length-1;h>=0;h--)a=l[h],a._boundsNeedUpdate&&a._recalculateBounds(),t.intersects(a._bounds)&&a._recursively(t,e,i,s,n)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var i=this._getCoord(e.x),s=this._getCoord(e.y),n=this._grid,l=n[s]=n[s]||{},r=l[i]=l[i]||[],h=L.Util.stamp(t);this._objectPoint[h]=e,r.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i=this._getCoord(e.x),s=this._getCoord(e.y),n=this._grid,l=n[s]=n[s]||{},r=l[i]=l[i]||[],h,a;for(delete this._objectPoint[L.Util.stamp(t)],h=0,a=r.length;h<a;h++)if(r[h]===t)return r.splice(h,1),a===1&&delete l[i],!0},eachObject:function(t,e){var i,s,n,l,r,h,a,u=this._grid;for(i in u){r=u[i];for(s in r)for(h=r[s],n=0,l=h.length;n<l;n++)a=t.call(e,h[n]),a&&(n--,l--)}},getNearObject:function(t){var e=this._getCoord(t.x),i=this._getCoord(t.y),s,n,l,r,h,a,u,o,g=this._objectPoint,c=this._sqCellSize,v=null;for(s=i-1;s<=i+1;s++)if(r=this._grid[s],r){for(n=e-1;n<=e+1;n++)if(h=r[n],h)for(l=0,a=h.length;l<a;l++)u=h[l],o=this._sqDist(g[L.Util.stamp(u)],t),(o<c||o<=c&&v===null)&&(c=o,v=u)}return v},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var i=e.x-t.x,s=e.y-t.y;return i*i+s*s}},function(){L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat,s=e[0].lng-e[1].lng;return s*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i=0,s=null,n=[],l,r,h;for(l=e.length-1;l>=0;l--){if(r=e[l],h=this.getDistant(r,t),h>0)n.push(r);else continue;h>i&&(i=h,s=r)}return{maxPoint:s,newPoints:n}},buildConvexHull:function(t,e){var i=[],s=this.findMostDistantPointFromBaseLine(t,e);return s.maxPoint?(i=i.concat(this.buildConvexHull([t[0],s.maxPoint],s.newPoints)),i=i.concat(this.buildConvexHull([s.maxPoint,t[1]],s.newPoints)),i):[t[0]]},getConvexHull:function(t){var e=!1,i=!1,s=!1,n=!1,l=null,r=null,h=null,a=null,u=null,o=null,g;for(g=t.length-1;g>=0;g--){var c=t[g];(e===!1||c.lat>e)&&(l=c,e=c.lat),(i===!1||c.lat<i)&&(r=c,i=c.lat),(s===!1||c.lng>s)&&(h=c,s=c.lng),(n===!1||c.lng<n)&&(a=c,n=c.lng)}i!==e?(o=r,u=l):(o=a,u=h);var v=[].concat(this.buildConvexHull([o,u],t),this.buildConvexHull([u,o],t));return v}}}(),L.MarkerCluster.include({getConvexHull:function(){var t=this.getAllChildMarkers(),e=[],i,s;for(s=t.length-1;s>=0;s--)i=t[s].getLatLng(),e.push(i);return L.QuickHull.getConvexHull(e)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var t=this.getAllChildMarkers(null,!0),e=this._group,i=e._map,s=i.latLngToLayerPoint(this._latlng),n;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?n=this._group.options.spiderfyShapePositions(t.length,s):t.length>=this._circleSpiralSwitchover?n=this._generatePointsSpiral(t.length,s):(s.y+=10,n=this._generatePointsCircle(t.length,s)),this._animationSpiderfy(t,n)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),s=i/this._2PI,n=this._2PI/t,l=[],r,h;for(s=Math.max(s,35),l.length=t,r=0;r<t;r++)h=this._circleStartAngle+r*n,l[r]=new L.Point(e.x+s*Math.cos(h),e.y+s*Math.sin(h))._round();return l},_generatePointsSpiral:function(t,e){var i=this._group.options.spiderfyDistanceMultiplier,s=i*this._spiralLengthStart,n=i*this._spiralFootSeparation,l=i*this._spiralLengthFactor*this._2PI,r=0,h=[],a;for(h.length=t,a=t;a>=0;a--)a<t&&(h[a]=new L.Point(e.x+s*Math.cos(r),e.y+s*Math.sin(r))._round()),r+=n/s+a*5e-4,s+=l/r;return h},_noanimationUnspiderfy:function(){var t=this._group,e=t._map,i=t._featureGroup,s=this.getAllChildMarkers(null,!0),n,l;for(t._ignoreMove=!0,this.setOpacity(1),l=s.length-1;l>=0;l--)n=s[l],i.removeLayer(n),n._preSpiderfyLatlng&&(n.setLatLng(n._preSpiderfyLatlng),delete n._preSpiderfyLatlng),n.setZIndexOffset&&n.setZIndexOffset(0),n._spiderLeg&&(e.removeLayer(n._spiderLeg),delete n._spiderLeg);t.fire("unspiderfied",{cluster:this,markers:s}),t._ignoreMove=!1,t._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var i=this._group,s=i._map,n=i._featureGroup,l=this._group.options.spiderLegPolylineOptions,r,h,a,u;for(i._ignoreMove=!0,r=0;r<t.length;r++)u=s.layerPointToLatLng(e[r]),h=t[r],a=new L.Polyline([this._latlng,u],l),s.addLayer(a),h._spiderLeg=a,h._preSpiderfyLatlng=h._latlng,h.setLatLng(u),h.setZIndexOffset&&h.setZIndexOffset(1e6),n.addLayer(h);this.setOpacity(.3),i._ignoreMove=!1,i.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var i=this,s=this._group,n=s._map,l=s._featureGroup,r=this._latlng,h=n.latLngToLayerPoint(r),a=L.Path.SVG,u=L.extend({},this._group.options.spiderLegPolylineOptions),o=u.opacity,g,c,v,C,M,x;for(o===void 0&&(o=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),a?(u.opacity=0,u.className=(u.className||"")+" leaflet-cluster-spider-leg"):u.opacity=o,s._ignoreMove=!0,g=0;g<t.length;g++)c=t[g],x=n.layerPointToLatLng(e[g]),v=new L.Polyline([r,x],u),n.addLayer(v),c._spiderLeg=v,a&&(C=v._path,M=C.getTotalLength()+.1,C.style.strokeDasharray=M,C.style.strokeDashoffset=M),c.setZIndexOffset&&c.setZIndexOffset(1e6),c.clusterHide&&c.clusterHide(),l.addLayer(c),c._setPos&&c._setPos(h);for(s._forceLayout(),s._animationStart(),g=t.length-1;g>=0;g--)x=n.layerPointToLatLng(e[g]),c=t[g],c._preSpiderfyLatlng=c._latlng,c.setLatLng(x),c.clusterShow&&c.clusterShow(),a&&(v=c._spiderLeg,C=v._path,C.style.strokeDashoffset=0,v.setStyle({opacity:o}));this.setOpacity(.3),s._ignoreMove=!1,setTimeout(function(){s._animationEnd(),s.fire("spiderfied",{cluster:i,markers:t})},200)},_animationUnspiderfy:function(t){var e=this,i=this._group,s=i._map,n=i._featureGroup,l=t?s._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):s.latLngToLayerPoint(this._latlng),r=this.getAllChildMarkers(null,!0),h=L.Path.SVG,a,u,o,g,c,v;for(i._ignoreMove=!0,i._animationStart(),this.setOpacity(1),u=r.length-1;u>=0;u--)a=r[u],a._preSpiderfyLatlng&&(a.closePopup(),a.setLatLng(a._preSpiderfyLatlng),delete a._preSpiderfyLatlng,v=!0,a._setPos&&(a._setPos(l),v=!1),a.clusterHide&&(a.clusterHide(),v=!1),v&&n.removeLayer(a),h&&(o=a._spiderLeg,g=o._path,c=g.getTotalLength()+.1,g.style.strokeDashoffset=c,o.setStyle({opacity:0})));i._ignoreMove=!1,setTimeout(function(){var C=0;for(u=r.length-1;u>=0;u--)a=r[u],a._spiderLeg&&C++;for(u=r.length-1;u>=0;u--)a=r[u],a._spiderLeg&&(a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),C>1&&n.removeLayer(a),s.removeLayer(a._spiderLeg),delete a._spiderLeg);i._animationEnd(),i.fire("unspiderfied",{cluster:e,markers:r})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){!this._map||this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,i;for(e in t)for(i=t[e].__parent;i;)i._iconNeedsUpdate=!0,i=i.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,i;for(e in t)i=t[e],this.hasLayer(i)&&i.setIcon(this._overrideMarkerIcon(i))}}),L.Marker.include({refreshIconOptions:function(t,e){var i=this.options.icon;return L.setOptions(i,t),this.setIcon(i),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),m.MarkerClusterGroup=p,m.MarkerCluster=y,Object.defineProperty(m,"__esModule",{value:!0})})})(T,T.exports);(function(){function _(f){return this instanceof _?(this._canvas=f=typeof f=="string"?document.getElementById(f):f,this._ctx=f.getContext("2d"),this._width=f.width,this._height=f.height,this._max=1,void this.clear()):new _(f)}_.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(f,m){return this._data=f,this},max:function(f){return this._max=f,this},add:function(f){return this._data.push(f),this},clear:function(){return this._data=[],this},radius:function(f,m){m=m||15;var p=this._circle=document.createElement("canvas"),y=p.getContext("2d"),t=this._r=f+m;return p.width=p.height=2*t,y.shadowOffsetX=y.shadowOffsetY=200,y.shadowBlur=m,y.shadowColor="black",y.beginPath(),y.arc(t-200,t-200,f,0,2*Math.PI,!0),y.closePath(),y.fill(),this},gradient:function(f){var m=document.createElement("canvas"),p=m.getContext("2d"),y=p.createLinearGradient(0,0,0,256);m.width=1,m.height=256;for(var t in f)y.addColorStop(t,f[t]);return p.fillStyle=y,p.fillRect(0,0,1,256),this._grad=p.getImageData(0,0,1,256).data,this},draw:function(f){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var m=this._ctx;m.clearRect(0,0,this._width,this._height);for(var p,y=0,t=this._data.length;t>y;y++)p=this._data[y],m.globalAlpha=Math.max(p[2]/this._max,f||.05),m.drawImage(this._circle,p[0]-this._r,p[1]-this._r);var e=m.getImageData(0,0,this._width,this._height);return this._colorize(e.data,this._grad),m.putImageData(e,0,0),this},_colorize:function(f,m){for(var p,y=3,t=f.length;t>y;y+=4)p=4*f[y],p&&(f[y-3]=m[p],f[y-2]=m[p+1],f[y-1]=m[p+2])}},window.simpleheat=_})(),L.HeatLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(_,f){this._latlngs=_,L.setOptions(this,f)},setLatLngs:function(_){return this._latlngs=_,this.redraw()},addLatLng:function(_){return this._latlngs.push(_),this.redraw()},setOptions:function(_){return L.setOptions(this,_),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return!this._heat||this._frame||this._map._animating||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(_){this._map=_,this._canvas||this._initCanvas(),_._panes.overlayPane.appendChild(this._canvas),_.on("moveend",this._reset,this),_.options.zoomAnimation&&L.Browser.any3d&&_.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(_){_.getPanes().overlayPane.removeChild(this._canvas),_.off("moveend",this._reset,this),_.options.zoomAnimation&&_.off("zoomanim",this._animateZoom,this)},addTo:function(_){return _.addLayer(this),this},_initCanvas:function(){var _=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),f=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);_.style[f]="50% 50%";var m=this._map.getSize();_.width=m.x,_.height=m.y;var p=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(_,"leaflet-zoom-"+(p?"animated":"hide")),this._heat=simpleheat(_),this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur),this.options.gradient&&this._heat.gradient(this.options.gradient),this.options.max&&this._heat.max(this.options.max)},_reset:function(){var _=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,_);var f=this._map.getSize();this._heat._width!==f.x&&(this._canvas.width=this._heat._width=f.x),this._heat._height!==f.y&&(this._canvas.height=this._heat._height=f.y),this._redraw()},_redraw:function(){var _,f,m,p,y,t,e,i,s,n=[],l=this._heat._r,r=this._map.getSize(),h=new L.Bounds(L.point([-l,-l]),r.add([l,l])),a=this.options.max===void 0?1:this.options.max,u=this.options.maxZoom===void 0?this._map.getMaxZoom():this.options.maxZoom,o=1/Math.pow(2,Math.max(0,Math.min(u-this._map.getZoom(),12))),g=l/2,c=[],v=this._map._getMapPanePos(),C=v.x%g,M=v.y%g;for(_=0,f=this._latlngs.length;f>_;_++)if(m=this._map.latLngToContainerPoint(this._latlngs[_]),h.contains(m)){y=Math.floor((m.x-C)/g)+2,t=Math.floor((m.y-M)/g)+2;var x=this._latlngs[_].alt!==void 0?this._latlngs[_].alt:this._latlngs[_][2]!==void 0?+this._latlngs[_][2]:1;s=x*o,c[t]=c[t]||[],p=c[t][y],p?(p[0]=(p[0]*p[2]+m.x*s)/(p[2]+s),p[1]=(p[1]*p[2]+m.y*s)/(p[2]+s),p[2]+=s):c[t][y]=[m.x,m.y,s]}for(_=0,f=c.length;f>_;_++)if(c[_])for(e=0,i=c[_].length;i>e;e++)p=c[_][e],p&&n.push([Math.round(p[0]),Math.round(p[1]),Math.min(p[2],a)]);this._heat.data(n).draw(this.options.minOpacity),this._frame=null},_animateZoom:function(_){var f=this._map.getZoomScale(_.zoom),m=this._map._getCenterOffset(_.center)._multiplyBy(-f).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,m,f):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(m)+" scale("+f+")"}}),L.heatLayer=function(_,f){return new L.HeatLayer(_,f)};const et={class:"rounded-xl border border-neutral-700 bg-neutral-900"},it={class:"p-3 flex items-center gap-3"},st=["value"],nt={__name:"PlaceMap",props:{apiUrl:{type:String,default:"/api/map/places"},eventsUrl:{type:String,default:"/api/map/events"}},setup(_){const f=_,m=O(null),p=O([]),y=O(null);let t,e,i,s;const n=async()=>{const a=await fetch(f.eventsUrl);p.value=await a.json()},l=async()=>{const a=new URL(f.apiUrl,window.location.origin);return y.value&&a.searchParams.set("event_id",y.value),await(await fetch(a)).json()},r=(a,u)=>a===0?"#808080":`hsl(${Math.round(120-120*(a/u))} 80% 45%)`,h=a=>{e||(e=S.markerClusterGroup({showCoverageOnHover:!1,maxClusterRadius:48}),t.addLayer(e)),e.clearLayers(),i&&t.removeLayer(i);const u=a.features.map(v=>v.properties.bikes_total||0),o=Math.max(...u,1),g=[];a.features.forEach(v=>{var I;if(!v.geometry)return;const[C,M]=v.geometry.coordinates,x=v.properties,z=a.features.map(H=>H.properties.reports_total||0),B=Math.max(...z,1),N=S.circleMarker([M,C],{radius:6+Math.round(12*(x.reports_total/B)),color:"#262626",weight:1,fillColor:r(x.reports_total,B),fillOpacity:.85}).bindPopup(`
      <div style="min-width:230px">
        <strong>${(I=x.name)!=null?I:"Unknown"} (#${x.id})</strong><br/>
        Bikes: <b>${x.bikes_total}</b><br/>
        Reports: <b>${x.reports_total}</b>
      </div>
    `);e.addLayer(N);const j=x.bikes_total?x.bikes_total/o:0;g.push([M,C,Math.max(.05,j)])}),i=S.heatLayer(g,{radius:28,blur:18,maxZoom:16,max:1}),s&&s.remove(),s=S.control.layers(null,{Clusters:e,Heatmap:i},{collapsed:!0}),s.addTo(t);const c=S.featureGroup(e.getLayers());c.getLayers().length&&t.fitBounds(c.getBounds().pad(.2))};return U(async()=>{t=S.map(m.value,{preferCanvas:!0,minZoom:3}),S.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap contributors"}).addTo(t),await n(),h(await l())}),E(y,async()=>{h(await l())}),(a,u)=>(k(),w("div",et,[d("div",it,[u[2]||(u[2]=d("h3",{class:"text-sm font-medium text-neutral-200"},"Places Map",-1)),q(d("select",{"onUpdate:modelValue":u[0]||(u[0]=o=>y.value=o),class:"text-sm bg-neutral-800 border border-neutral-700 rounded px-2 py-1"},[u[1]||(u[1]=d("option",{value:null},"All events",-1)),(k(!0),w(D,null,R(p.value,o=>(k(),w("option",{key:o.id,value:o.id},b(o.date)+" (id: "+b(o.id)+") ",9,st))),128))],512),[[$,y.value]]),u[3]||(u[3]=d("div",{class:"ml-auto text-xs text-neutral-400"}," Legend: small/grey = 0 reports; larger/green \u2192 more reports ",-1))]),d("div",{ref_key:"mapEl",ref:m,style:{height:"540px"}},null,512)]))}},rt=J(nt,[["__scopeId","data-v-b4dacad7"]]);A.register(...tt);const ot={class:"border border-zinc-800 bg-zinc-900 p-6 shadow-xl shadow-black/30 mb-6"},at={class:"flex items-center justify-between mb-5"},lt={key:0,class:"text-xs text-emerald-400 inline-flex items-center gap-2"},ht={class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4"},ut={class:"border border-zinc-800 bg-zinc-950/50 p-5"},dt={class:"text-3xl font-bold tracking-tight"},_t={class:"border border-zinc-800 bg-zinc-950/50 p-5"},ct={class:"text-3xl font-bold tracking-tight"},ft={class:"border border-zinc-800 bg-zinc-950/50 p-5"},pt={class:"text-3xl font-bold tracking-tight"},mt={class:"border border-zinc-800 bg-zinc-950/50 p-5"},gt={class:"text-3xl font-bold tracking-tight"},vt={class:"border border-zinc-800 bg-zinc-900 p-6 shadow-xl shadow-black/30 mb-6"},Lt={class:"border border-zinc-800 bg-zinc-950/50 p-5"},yt={class:"h-64"},xt={class:"mt-3 text-[11px] text-zinc-500"},Ct={class:"border border-zinc-800 bg-zinc-900 p-6 shadow-xl shadow-black/30"},bt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Mt={class:"lg:col-span-1 border border-zinc-800 bg-zinc-950/50 p-5"},kt={key:0,class:"space-y-2"},wt={class:"text-sm text-zinc-300"},St=["href"],Pt={class:"font-medium"},zt={class:"text-sm text-zinc-300"},Ot={class:"font-semibold"},Gt={class:"text-xs leading-relaxed text-zinc-300"},Bt={class:"mt-3 flex items-center gap-2"},It={class:"text-[11px] text-zinc-500"},Zt={key:1,class:"text-sm text-zinc-400"},Tt={class:"lg:col-span-2 border border-zinc-800 bg-zinc-950/50 p-0"},Ut={class:"overflow-x-auto"},Et={class:"min-w-full text-sm"},Dt={class:"py-3 px-5 font-mono text-zinc-300"},Rt=["href"],At={class:"py-3 px-5 text-zinc-200"},Nt={class:"py-3 px-5 font-semibold"},jt=["title"],Ht={class:"py-3 px-5 text-zinc-400"},Ft={key:0,class:"border-t border-zinc-900/70"},Qt={__name:"Dashboard",props:{kpi:Object,next_event:Object,reports_stat:Object},setup(_){const f=W();P(()=>{var u,o;return(o=(u=f.props.auth)==null?void 0:u.user)!=null?o:null});const m=_,p=u=>typeof u=="number"?u.toLocaleString("en-US"):u,y=u=>{if(!u)return"\u2014";if(u.includes("-")){const o=u.split("-");if(o[0].length===4){const[g,c,v]=o;return new Date(`${g}-${c}-${v}T00:00:00Z`).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}else{const[g,c,v]=o;return new Date(`${v}-${c}-${g}T00:00:00Z`).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"2-digit"})}}return u},t=P(()=>{var u,o;return(o=(u=m.kpi)==null?void 0:u.topEvents)!=null?o:[]}),e=P(()=>{var u,o;return((o=(u=t.value)==null?void 0:u.length)!=null?o:0)>0}),i=P(()=>e.value?[...t.value].sort((u,o)=>o.reports_count-u.reports_count)[0]:null),s=P(()=>{const u=m.reports_stat||{};return Object.entries(u).map(([o,g])=>({date:o,count:g})).sort((o,g)=>o.date.localeCompare(g.date))}),n=P(()=>s.value.map(u=>u.date)),l=P(()=>s.value.map(u=>u.count)),r=O(null);let h=null;const a=()=>{if(!r.value)return;const u=r.value.getContext("2d");h&&h.destroy(),h=new A(u,{type:"line",data:{labels:n.value,datasets:[{label:"Reports per event date",data:l.value,tension:.25,pointRadius:2,borderWidth:2,fill:!0,backgroundColor:o=>{const{chart:g}=o,{ctx:c,chartArea:v}=g;if(!v)return;const C=c.createLinearGradient(0,v.top,0,v.bottom);return C.addColorStop(0,"rgba(16,185,129,0.75)"),C.addColorStop(1,"rgba(16,185,129,0.02)"),C}}]},options:{maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1}},interaction:{mode:"nearest",intersect:!1},scales:{x:{ticks:{maxRotation:0,autoSkip:!0,autoSkipPadding:12},grid:{display:!1}},y:{beginAtZero:!0,grid:{color:"rgba(255,255,255,0.06)"}}}}})};return U(()=>a()),Q(()=>{h&&h.destroy()}),E([n,l],()=>a()),(u,o)=>(k(),X(F,{title:"Dashboard"},{default:K(()=>{var g,c,v,C,M;return[o[22]||(o[22]=d("section",{class:"border border-zinc-800 bg-zinc-900 p-6 shadow-xl shadow-black/30 mb-6"},[d("header",{class:"flex items-center justify-between mb-3"},[d("h3",{class:"text-lg font-semibold"},"Welcome"),d("span",{class:"text-xs text-zinc-400"},'"Pils\u0113ta cilv\u0113kiem veloskait\u012B\u0161ana" Control Center')]),d("p",{class:"text-sm text-zinc-300"}," Use the left sidebar to manage members, programs, events, and reports. Keep it lean: fast approvals, clean records, transparent updates. ")],-1)),d("section",ot,[d("header",at,[o[1]||(o[1]=d("h3",{class:"text-lg font-semibold"},"KPI \u2014 At a glance",-1)),(g=_.next_event)!=null&&g.read?(k(),w("span",lt,[o[0]||(o[0]=d("span",{class:"inline-block h-2 w-2 bg-emerald-400 animate-pulse"},null,-1)),G(" Next count: "+b(_.next_event.read)+" ("+b(y(_.next_event.date))+") ",1)])):Z("",!0)]),d("div",ht,[d("div",ut,[o[2]||(o[2]=d("div",{class:"text-xs text-zinc-400 mb-2"},"Total bikes counted",-1)),d("div",dt,b(p((c=_.kpi)==null?void 0:c.bikesOverall)),1),o[3]||(o[3]=d("div",{class:"mt-3 text-[11px] text-zinc-500"},"Cumulative across all approved reports.",-1))]),d("div",_t,[o[4]||(o[4]=d("div",{class:"text-xs text-zinc-400 mb-2"},"Reports",-1)),d("div",ct,b(p((v=_.kpi)==null?void 0:v.reports)),1),o[5]||(o[5]=d("div",{class:"mt-3 text-[11px] text-zinc-500"},"Submitted & stored in the archive.",-1))]),d("div",ft,[o[6]||(o[6]=d("div",{class:"text-xs text-zinc-400 mb-2"},"Events",-1)),d("div",pt,b(p((C=_.kpi)==null?void 0:C.events)),1),o[7]||(o[7]=d("div",{class:"mt-3 text-[11px] text-zinc-500"},"Unique counting days/locations.",-1))]),d("div",mt,[o[8]||(o[8]=d("div",{class:"text-xs text-zinc-400 mb-2"},"Max reports / single event",-1)),d("div",gt,b(p((M=_.kpi)==null?void 0:M.maxReports)),1),o[9]||(o[9]=d("div",{class:"mt-3 h-2 w-full bg-zinc-800 overflow-hidden"},[d("div",{class:"h-2 bg-emerald-500 w-full"})],-1)),o[10]||(o[10]=d("div",{class:"mt-3 text-[11px] text-zinc-500"},"Benchmark day with peak submissions.",-1))])])]),d("section",vt,[o[12]||(o[12]=d("header",{class:"flex items-center justify-between mb-4"},[d("h3",{class:"text-lg font-semibold"},"Reports \u2014 Trends"),d("div",{class:"text-xs text-zinc-400"},"Charted with Chart.js for quick pattern recognition.")],-1)),d("div",Lt,[o[11]||(o[11]=d("div",{class:"text-xs text-zinc-400 mb-2"},"Per-event submissions over time",-1)),d("div",yt,[d("canvas",{ref_key:"lineRef",ref:r},null,512)]),d("div",xt,"Each point = one counting event date ("+b(n.value.length)+" total).",1)])]),d("section",Ct,[o[21]||(o[21]=d("header",{class:"flex items-center justify-between mb-4"},[d("h3",{class:"text-lg font-semibold"},"Reports \u2014 Highlights"),d("div",{class:"text-xs text-zinc-400"},"Data quality first: completeness, clarity, and weather context.")],-1)),d("div",bt,[d("div",Mt,[o[17]||(o[17]=d("div",{class:"text-xs text-zinc-400 mb-2"},"Top event by report count",-1)),i.value?(k(),w("div",kt,[d("div",wt,[o[13]||(o[13]=G("Date: ",-1)),d("a",{href:"/dashboard/reports/list/"+i.value.id},[d("span",Pt,b(y(i.value.date)),1)],8,St)]),d("div",zt,[o[14]||(o[14]=G("Reports: ",-1)),d("span",Ot,b(p(i.value.reports_count)),1)]),o[16]||(o[16]=d("div",{class:"text-xs text-zinc-400"},"Weather:",-1)),d("p",Gt,b(i.value.weather),1),d("div",Bt,[o[15]||(o[15]=d("span",{class:"inline-block h-1.5 w-1.5 bg-emerald-500"},null,-1)),d("span",It,"Created "+b(new Date(i.value.created_at).toLocaleDateString("en-GB")),1)])])):(k(),w("div",Zt,"No top events yet."))]),d("div",Tt,[o[20]||(o[20]=d("div",{class:"px-5 py-4 border-b border-zinc-800 flex items-center justify-between"},[d("div",{class:"text-sm font-medium"},"Top events"),d("div",{class:"text-[11px] text-zinc-500"},"Sorted by reports count (desc)")],-1)),d("div",Ut,[d("table",Et,[o[19]||(o[19]=d("thead",{class:"text-left text-zinc-400"},[d("tr",{class:"border-b border-zinc-800"},[d("th",{class:"py-3 px-5"},"ID"),d("th",{class:"py-3 px-5"},"Date"),d("th",{class:"py-3 px-5"},"Reports"),d("th",{class:"py-3 px-5"},"Weather"),d("th",{class:"py-3 px-5"},"Created")])],-1)),d("tbody",null,[(k(!0),w(D,null,R([...t.value].sort((x,z)=>z.reports_count-x.reports_count),x=>(k(),w("tr",{key:x.id,class:"border-b border-zinc-900/70 hover:bg-zinc-900/60"},[d("td",Dt,[d("a",{href:"/dashboard/reports/list/"+x.id},"#"+b(x.id),9,Rt)]),d("td",At,b(y(x.date)),1),d("td",Nt,b(p(x.reports_count)),1),d("td",{class:"py-3 px-5 text-zinc-300 max-w-[28rem] truncate",title:x.weather},b(x.weather),9,jt),d("td",Ht,b(new Date(x.created_at).toLocaleDateString("en-GB")),1)]))),128)),e.value?Z("",!0):(k(),w("tr",Ft,[...o[18]||(o[18]=[d("td",{colspan:"5",class:"py-6 px-5 text-center text-zinc-500"},"No events available.",-1)])]))])])])])])]),Y(rt)]}),_:1}))}};export{Qt as default};
